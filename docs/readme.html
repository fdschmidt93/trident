<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Customization" href="customization.html" /><link rel="prev" title="Indices and tables" href="index.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Notices - trident documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">trident  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">trident  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="customization.html">Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="trident.core.html">trident.core package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="trident.core.mixins.html">trident.core.mixins package</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <span class="target" id="readme"></span><div class="section" id="notices">
<h1>Notices<a class="headerlink" href="#notices" title="Permalink to this headline">¶</a></h1>
<p>trident currently undergoes heavy development. The README and associated documentation needs to be vastly updated to reflect the changes in the code. That said, the documentation for individual functions in many cases still works as expected.</p>
<div class="section" id="using-project">
<h2>Using trident<a class="headerlink" href="#using-project" title="Permalink to this headline">¶</a></h2>
<p>trident is generic framework to train and evaluate (deep learning) models and represents a thin layer of convenience on top of</p>
<ul class="simple">
<li><p><a class="reference external" href="https://https://pytorch.org/">Pytorch</a></p></li>
<li><p><a class="reference external" href="https://pytorch-lightning.readthedocs.io/">Pytorch-Lightning</a></p></li>
<li><p><a class="reference external" href="https://hydra.cc">Hydra</a></p></li>
<li><p><a class="reference external" href="https://huggingface.co/docs/datasets/">datasets</a></p></li>
<li><p><a class="reference external" href="https://huggingface.co/transformers/">transformers</a></p></li>
<li><p><a class="reference external" href="https://torchmetrics.readthedocs.io/">torchmetrics</a></p></li>
</ul>
<p>In particular, trident intends to abstract any boilerplate away in a highly modular fashion:</p>
<ul class="simple">
<li><p>Data &amp; Preprocessing pipeline powered by <a class="reference external" href="https://huggingface.co/docs/datasets/">datasets</a> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">lightning.LightningDataModule</span></code>: user setup required</p></li>
<li><p>Training and Evaluation wrappers constitute convenience layers around <a class="reference external" href="https://pytorch-lightning.readthedocs.io/">Pytorch-Lightning</a></p></li>
</ul>
<p>You can opt-out of any component and replace it with your implementation with ease (see <a class="reference internal" href="customization.html#customization"><span class="std std-ref">Customization</span></a>). It is quintessential that you familiarize yourself with Hydra as it constitutes the backbone for composing experiments in trident.</p>
</div>
</div>
<div class="section" id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<p>All necessary packages for a base installation of trident can be installed with the <a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">conda package manager</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda env create -f environment.yaml
conda activate trident
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Simplicity:</strong> follow existing patterns (e.g. naming conventions) of our stack as much as possible for easy understanding and extending</p></li>
<li><p><strong>Low code:</strong> trident is a wrapper first – prefer implementations from well-maintained frameworks</p></li>
<li><p><strong>Out-of-the-box:</strong> provide readily available pipelines for popular benchmark datasets</p></li>
</ul>
<p>That said, you are encouraged to check the source code of the primary modules <span class="xref std std-doc">src.modules</span> and <span class="xref std std-doc">src.datamodules</span> which are thin wrappers around <a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/latest/common/lightning_module.html">LightningModule</a> and <a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/latest/extensions/datamodules.html">LightningDataModule</a>, respectively.</p>
<p>Typical usage of trident follows the below schema:</p>
<ol class="arabic simple">
<li><p>Clone the repo</p></li>
<li><p>Write a configuration for your model (see also <a class="reference internal" href="customization.html#customization"><span class="std std-ref">Customization</span></a>)</p></li>
<li><p>Train on an existing experiment with <cite>python run.py experiment=mnli module=my_model</cite></p></li>
</ol>
<p>You can find existing pipelines at <a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/configs/experiment/">experiments configs</a>. A full experiment (incl. <cite>module</cite>) is defined in the <a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/configs/experiment/mnli_tinybert.yaml">MNLI-TinyBert config</a>.</p>
<p><strong>Important Concepts</strong>:</p>
<ul>
<li><p><cite>module</cite> encapsulates a <code class="xref py py-obj docutils literal notranslate"><span class="pre">lightning.LightningModule</span></code> in a Hydra config (example: <a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/configs/module/sequence_classification.yaml">sequence classification</a>) and comprises the following keys:</p>
<blockquote>
<div><ul class="simple">
<li><p>model: your model that returns a container with loss and required attributes</p></li>
<li><p><a class="reference internal" href="customization.html#evaluation"><span class="std std-ref">evaluation</span></a>: use and existing or customized evaluation config</p></li>
<li><p>optimizer: the optimizer for training</p></li>
<li><p>scheduler: the scheduler for optimization</p></li>
<li><p><a class="reference internal" href="customization.html#function-override"><span class="std std-ref">overrides</span></a>: override and add single methods of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">TridentModule</span></code></p></li>
<li><p><span class="xref std std-ref">mixins</span>: override and add groups of methods of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">TridentModule</span></code></p></li>
</ul>
<p>Please see more details in <span class="xref std std-ref">trident_module</span>.</p>
</div></blockquote>
</li>
<li><p><cite>datamodule</cite> represents a <code class="xref py py-obj docutils literal notranslate"><span class="pre">lightning.LightningDataModule</span></code> in a Hydra config (example: <a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/configs/datamodule/mnli.yaml">MNLI</a>)</p></li>
<li><p><cite>experiment</cite> constitutes a set of configuration that typically defines everything except for the <cite>model</cite></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── configs             &lt;- Hydra configuration files
│   ├── callbacks         &lt;- Model training callbacks
│   ├── datamodule        &lt;- Datamodule configs
│   ├── experiment        &lt;- Experiment configs encapsulate **at least** everything except model (but may include models)
│   ├── hparams_search    &lt;- Hyperparameter search configs
│   ├── hydra             &lt;- Hydra related configs
│   ├── logger            &lt;- Logger configs
│   ├── module            &lt;- Module configs: model (mixins &amp; overrides), optimizer, scheduler
│   ├── trainer           &lt;- Trainer configs
│   │
│   └── config.yaml       &lt;- Main project configuration file
│
├── logs                &lt;- Logs generated by Hydra &amp; PyTorch Lightning loggers
│
├── tests               &lt;- Tests of any kind
│   ├── helpers           &lt;- A couple of testing utilities
│   ├── shell             &lt;- Shell/command based tests
│   └── unit              &lt;- Unit tests
│
├── src
│   ├── callbacks
│   ├── datamodules
│   ├── modules
│   │  ├──── base         &lt;- Definition of TridentModule
│   │  ├──── mixins       &lt;- Extend TridentModule with methods
│   │  └──── functional   &lt;- Extend TridentModule functionally
│   ├── utils
│   │
│   └── train.py          &lt;- Training pipeline
</pre></div>
</div>
<p>Most importantly, trident allows you to:</p>
<ul class="simple">
<li><p>Use your own LightningModules</p></li>
<li><p>Embed your own model into the TridentModule</p></li>
<li><p>Easily leverage existing frameworks like <a class="reference external" href="https://huggingface.co/transformers/">transformers</a> (see below)</p></li>
</ul>
<p>A <cite>TridentModule</cite> is analogous to what a <code class="xref py py-obj docutils literal notranslate"><span class="pre">lightning.LightningDataModule</span></code> comprises (model, optimizer, scheduler, …) and commonly defined with <strong>shared and individual flags</strong>. Here’s an example for sequence classification.</p>
<p>First, the included model configurations inherit <strong>shared options</strong> from the <a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/configs/module/base.yaml">base module config</a>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">_recursive_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src.modules.base.TridentModule</span>
<span class="nt">defaults</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">/optimizer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${optimizer}</span>  <span class="c1"># global default (adamw: /configs/optimizer/adamw.yaml</span>
<span class="p p-Indicator">-</span> <span class="nt">/scheduler</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${scheduler}</span>  <span class="c1"># global default (linear warmup: /configs/scheduler/linear_warm_up.yaml)</span>
</pre></div>
</div>
<p><cite>/configs/module/sequence_classification.yaml</cite></p>
<p>For instance, you can then</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># change the learning rate</span>
python run.py <span class="nv">experiment</span><span class="o">=</span>mnli optimizer.lr<span class="o">=</span><span class="m">0</span>.0001
<span class="c1"># set a different optimizer</span>
python run.py <span class="nv">experiment</span><span class="o">=</span>mnli <span class="nv">optimizer</span><span class="o">=</span>adam  <span class="c1"># see /configs/optimizer/</span>
<span class="c1"># no lr scheduler</span>
python run.py <span class="nv">experiment</span><span class="o">=</span>mnli <span class="nv">scheduler</span><span class="o">=</span>null
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">defaults</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">base</span> <span class="c1"># inherit config from /configs/module/base.yaml</span>
<span class="p p-Indicator">-</span> <span class="nt">/evaluation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">classification</span> <span class="c1">#</span>
<span class="c1"># optionally</span>
<span class="p p-Indicator">-</span> <span class="nt">/overrides</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="c1"># you can set instructions here on how to embed your own model</span>
<span class="nt">model</span><span class="p">:</span>
  <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">transformers.AutoModelForSequenceClassification.from_pretrained</span>
  <span class="nt">num_labels</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">???</span>
  <span class="nt">pretrained_model_name_or_path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">???</span>
</pre></div>
</div>
<p>Should you embed your own model, a TridentModule requires the model to <cite>forward</cite> be analogous to Huggingface transformers models, see the <code class="xref py py-meth docutils literal notranslate"><span class="pre">src.modules.base.TridentModule.training_step()</span></code>. Your model output should contain all required attributes for evaluation.</p>
<p>The <cite>TridentModule</cite> by default incorporates mixins for optimizer configuration and custom evaluation loops for the respective tasks (see <a class="reference internal" href="customization.html#evaluation"><span class="std std-ref">Evaluation</span></a>).</p>
<p>TODO</p>
<p>trident allows you to integrate your existing projects via:</p>
<ul class="simple">
<li><p>Extend Python path: add an existing project to scope of trident easily</p></li>
<li><dl class="simple">
<dt>Hook required functionality into training via</dt><dd><ol class="arabic simple">
<li><p>Linking your own functions</p></li>
<li><p>Pytorch-Lightning</p></li>
<li><p>Explicit method overrides</p></li>
<li><p>Incorporating custom mixins</p></li>
</ol>
</dd>
</dl>
</li>
</ul>
<p>For details on how to incorporate custom models or datamodules into the framework, see <a class="reference internal" href="customization.html#customization"><span class="std std-ref">Customization</span></a>.</p>
<p>Please see <a class="reference internal" href="CONTRIBUTING.html#contributing"><span class="std std-ref">Contributing</span></a>!</p>
<ul class="simple">
<li><p>This project is was largely inspired by and is based on <a class="reference external" href="https://github.com/ashleve/lightning-hydra-template">https://github.com/ashleve/lightning-hydra-template</a></p></li>
<li><p>A related project is: <a class="reference external" href="https://github.com/PyTorchLightning/lightning-transformers">https://github.com/PyTorchLightning/lightning-transformers</a></p></li>
</ul>
<div class="line-block">
<div class="line">Name: Fabian David Schmidt</div>
<div class="line">Mail: <a class="reference external" href="mailto:fabian.schmidt%40uni-wuerzburg.de">fabian<span>.</span>schmidt<span>@</span>uni-wuerzburg<span>.</span>de</a></div>
<div class="line">Affiliation: University of Würzburg</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="customization.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Customization</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Fabian David Schmidt |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="_sources/readme.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Notices</a><ul>
<li><a class="reference internal" href="#using-project">Using trident</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quick-start">Quick Start</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    </body>
</html>