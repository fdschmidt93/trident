<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="trident.core package" href="trident.core.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>trident.core.mixins package - trident documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">trident  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">trident  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#quick-start">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="customization.html">Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="trident.core.html">trident.core package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">trident.core.mixins package</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="trident-core-mixins-package">
<h1>trident.core.mixins package<a class="headerlink" href="#trident-core-mixins-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-trident.core.mixins.evaluation">
<span id="trident-core-mixins-evaluation-module"></span><h2>trident.core.mixins.evaluation module<a class="headerlink" href="#module-trident.core.mixins.evaluation" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">trident.core.mixins.evaluation.</span></span><span class="sig-name descname"><span class="pre">EvalMixin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L19-L626"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lightning.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.eval_step">
<span class="sig-name descname"><span class="pre">eval_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L473-L534"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.eval_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs model forward &amp; user batch transformation in an eval step.</p>
<p>This function is called in <cite>validation_step</cite> and <cite>test_step</cite> of the LightningModule.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.hparams">
<span class="sig-name descname"><span class="pre">hparams</span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.hparams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.log">
<span class="sig-name descname"><span class="pre">log</span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin for base model to define evaluation loop largely via hydra.</p>
<p>The evaluation mixin enables writing evaluation via yaml files, here is an
example for sequence classification, borrowed from configs/evaluation/classification.yaml.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply transformation function</span>
<span class="nt">prepare_cfg</span><span class="p">:</span>
  <span class="nt">batch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span> <span class="c1"># on each step</span>
  <span class="nt">outputs</span><span class="p">:</span>    <span class="c1"># on each step</span>
    <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src.utils.hydra.partial</span>
    <span class="nt">_partial_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src.evaluation.classification.get_preds</span>
    <span class="nt">.. code-block</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>

        <span class="l l-Scalar l-Scalar-Plain"># we link evaluation.apply.outputs against get_preds</span>
        <span class="l l-Scalar l-Scalar-Plain">def get_preds(outputs)</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">outputs.preds = outputs.logits.argmax(dim=-1)</span>
            <span class="l l-Scalar l-Scalar-Plain">return outputs</span>

  <span class="nt">step_outputs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>  <span class="c1"># on flattened outputs of what's collected from steps</span>
<span class="c1"># Which keys/attributes are supposed to be collected from `outputs` and `batch`</span>
<span class="nt">step_outputs</span><span class="p">:</span>
  <span class="nt">outputs</span><span class="p">:</span> <span class="s">"preds"</span> <span class="c1"># can be a str</span>
  <span class="nt">batch</span><span class="p">:</span> <span class="c1"># or a list[str]</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">labels</span>

<span class="c1"># either metrics or val_metrics and test_metrics</span>
<span class="c1"># where the latter</span>
<span class="nt">metrics_cfg</span><span class="p">:</span>
  <span class="c1"># name of the metric used eg for logging</span>
  <span class="nt">accuracy</span><span class="p">:</span>
    <span class="c1"># instructions to instantiate metric, preferrably torchmetrics.Metric</span>
    <span class="nt">metric</span><span class="p">:</span>
      <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">torchmetrics.Accuracy</span>
    <span class="c1"># either on_step: true or on_epoch: true</span>
    <span class="nt">on_step</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">compute</span><span class="p">:</span>
      <span class="nt">preds</span><span class="p">:</span> <span class="s">"outputs:preds"</span>
      <span class="nt">target</span><span class="p">:</span> <span class="s">"batch:labels"</span>
  <span class="nt">f1</span><span class="p">:</span>
    <span class="nt">metric</span><span class="p">:</span>
      <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">torchmetrics.F1</span>
    <span class="nt">on_step</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">compute</span><span class="p">:</span>
      <span class="nt">preds</span><span class="p">:</span> <span class="s">"outputs:preds"</span>
      <span class="nt">target</span><span class="p">:</span> <span class="s">"batch:labels"</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.log_metric">
<span class="sig-name descname"><span class="pre">log_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">omegaconf.base.DictKeyType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L156-L189"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.log_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Log a metric for a given stage with optional transformation.</p>
<p>Parameters:
- stage (str): The evaluation stage (e.g., “train”, “val”, “test”).
- metric_key (Union[str, DictKeyType]): Key identifying the metric.
- input (Union[int, float, dict]): Metric value or dictionary of metric values.
- log_kwargs (Optional[dict[str, Any]]): Additional keyword arguments for logging.
- dataset_name (Optional[str]): Name of the dataset if available.</p>
<p>Notes:
- This method assumes the existence of <cite>self.evaluation.metrics_cfg</cite>.
- If <cite>input</cite> is a dictionary, each key-value pair is logged separately with the appropriate prefix.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.on_eval_epoch_end">
<span class="sig-name descname"><span class="pre">on_eval_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L570-L610"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.on_eval_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and log metrics for all datasets at the epoch’s end.</p>
<p>This method determines if multiple datasets exist for the evaluation stage and
appropriately logs the metrics for each.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stage</strong> (<em>str</em>) – Evaluation stage, e.g., “val” or “test”.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.on_eval_start">
<span class="sig-name descname"><span class="pre">on_eval_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L81-L119"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.on_eval_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the metrics configurations and move metrics to the appropriate device at the beginning of evaluation.</p>
<p>This method handles metrics configuration at the start of evaluation for a given stage.
It ensures that all metrics are moved to the appropriate device. Additionally, for datasets
that have specific configurations, this method deepcopies the original metrics configuration
for each dataset, ensuring each dataset has its own configuration.</p>
<p>Parameters:
- stage (str): The evaluation stage, e.g., “train”, “val”, “test”.</p>
<p>Returns:
- None</p>
<p>Notes:
- This method assumes the existence of <cite>self.evaluation.metrics_cfg</cite> and <cite>self.trainer.datamodule</cite>.
- Metrics if PyTorch objects like <cite>torchmetrics</cite> OOP API are moved between devices.
- The method is private and should not be called outside of this class.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.on_test_epoch_end">
<span class="sig-name descname"><span class="pre">on_test_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L625-L626"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.on_test_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.on_test_start">
<span class="sig-name descname"><span class="pre">on_test_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L153-L154"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.on_test_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.on_validation_epoch_end">
<span class="sig-name descname"><span class="pre">on_validation_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L617-L618"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.on_validation_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.on_validation_start">
<span class="sig-name descname"><span class="pre">on_validation_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L150-L151"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.on_validation_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.prepare_batch">
<span class="sig-name descname"><span class="pre">prepare_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L235-L289"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.prepare_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the batch data for a given evaluation stage, and, optionally, for a specific dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stage</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Evaluation stage, such as ‘train’, ‘validation’, or ‘test’.</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – Batch data to be prepared.</p></li>
<li><p><strong>dataset</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[str]</span></code>, <cite>optional</cite>) – Name of the dataset, if specified. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Prepared batch data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Configuration for this function can be specified in Hydra. If working with a single
dataset or all datasets have the same configuration, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">yaml</span></code> would look like:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">prepare_cfg</span><span class="p">:</span>
  <span class="nt">batch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>  <span class="c1"># takes (module: TridentModule, batch: dict, stage: star)</span>
  <span class="nt">outputs</span><span class="p">:</span>     <span class="c1"># takes (module: TridentModule, outputs: dict, batch: dict, stage: str)</span>
    <span class="nt">_partial_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src.tasks.text_classification.eval.get_preds</span>
    <span class="c1"># takes (module: TridentModule, flattened_step_outputs: dict, stage: str)</span>
    <span class="c1"># where list of step_outputs are flattened</span>
  <span class="nt">step_outputs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
<p>For many heterogeneous datasets, configuration varies. Each dataset may now require separate configuration!</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">prepare_cfg</span><span class="p">:</span>
  <span class="nt">batch</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>  <span class="c1"># specification not required</span>
  <span class="nt">outputs</span><span class="p">:</span>
    <span class="nt">_datasets_</span><span class="p">:</span>
      <span class="nt">validation_ppl</span><span class="p">:</span>
        <span class="nt">_partial_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src.tasks.language_modeling.eval.get_num_tokens</span>
      <span class="nt">validation_nli</span><span class="p">:</span>
        <span class="nt">_partial_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src.tasks.text_classification.eval.get_preds</span>
      <span class="nt">test_nli</span><span class="p">:</span>
        <span class="nt">_partial_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">_target_</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src.tasks.text_classification.eval.get_preds</span>
  <span class="nt">step_outputs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>  <span class="c1"># specification not required</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.prepare_outputs">
<span class="sig-name descname"><span class="pre">prepare_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L291-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.prepare_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the output data for a given evaluation stage, and, optionally, for a specific dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stage</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Evaluation stage, such as ‘train’, ‘validation’, or ‘test’.</p></li>
<li><p><strong>outputs</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – Output data to be prepared.</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – Batch data.</p></li>
<li><p><strong>dataset</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[str]</span></code>, <cite>optional</cite>) – Name of the dataset, if specified. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Prepared outputs data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Configuration for this function can be specified in Hydra. Format depends on whether
working with a single dataset, many homogeneous datasets, or many heterogeneous datasets.
Refer to the provided examples.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.prepare_step_outputs">
<span class="sig-name descname"><span class="pre">prepare_step_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_outputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L320-L348"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.prepare_step_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the step outputs for a given evaluation stage, and, optionally, for a specific dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stage</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Evaluation stage, such as ‘train’, ‘validation’, or ‘test’.</p></li>
<li><p><strong>step_outputs</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – Step outputs data to be prepared.</p></li>
<li><p><strong>dataset</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[str]</span></code>, <cite>optional</cite>) – Name of the dataset, if specified. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Prepared step outputs data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Configuration for this function can be specified in Hydra. Format depends on whether
working with a single dataset, many homogeneous datasets, or many heterogeneous datasets.
Refer to the provided examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#trident.core.mixins.evaluation.EvalMixin.prepare_batch" title="trident.core.mixins.evaluation.EvalMixin.prepare_batch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trident.core.mixins.evaluation.EvalMixin.prepare_batch()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L620-L623"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.test_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.evaluation.EvalMixin.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/evaluation.py#L612-L615"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.evaluation.EvalMixin.validation_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
</div>
<div class="section" id="module-trident.core.mixins.optimizer">
<span id="trident-core-mixins-optimizer-module"></span><h2>trident.core.mixins.optimizer module<a class="headerlink" href="#module-trident.core.mixins.optimizer" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="trident.core.mixins.optimizer.OptimizerMixin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">trident.core.mixins.optimizer.</span></span><span class="sig-name descname"><span class="pre">OptimizerMixin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/optimizer.py#L16-L118"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.optimizer.OptimizerMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lightning.</span></code></p>
<p>Mixin for base model to define configuration of optimizer and scheduler.</p>
<dl class="simple">
<dt>The OptimizerMixin provides functionality to:</dt><dd><ul class="simple">
<li><p>compute the number of training steps (<a class="reference internal" href="#trident.core.mixins.optimizer.OptimizerMixin.num_training_steps" title="trident.core.mixins.optimizer.OptimizerMixin.num_training_steps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerMixin.num_training_steps</span></code></a>)</p></li>
<li><p>configure the optimizer(s) (<a class="reference internal" href="#trident.core.mixins.optimizer.OptimizerMixin.configure_optimizers" title="trident.core.mixins.optimizer.OptimizerMixin.configure_optimizers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerMixin.configure_optimizers</span></code></a>)</p></li>
<li><p>configure the scheduler (<a class="reference internal" href="#trident.core.mixins.optimizer.OptimizerMixin.configure_scheduler" title="trident.core.mixins.optimizer.OptimizerMixin.configure_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimizerMixin.configure_scheduler</span></code></a>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul class="simple">
<li><p>Optimizer: <a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/configs/optimizer/adamw.yaml">AdamW</a></p></li>
<li><p>Scheduler: <a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/configs/scheduler/linear_warm_up.yaml">Linear Warm-Up</a></p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.optimizer.OptimizerMixin.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/optimizer.py#L90-L118"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.optimizer.OptimizerMixin.configure_optimizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares optimizer and scheduler.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="trident.core.mixins.optimizer.OptimizerMixin.configure_scheduler">
<span class="sig-name descname"><span class="pre">configure_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.optim.Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.optim.lr_scheduler.LambdaLR</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/optimizer.py#L51-L88"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.optimizer.OptimizerMixin.configure_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the LR scheduler for the optimizer.</p>
<p>The instantiation of the scheduler takes the optimizer as the first positional argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># hparams.scheduler: passed config</span>
<span class="n">scheduler</span><span class="p">:</span> <span class="n">LambdaLR</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hparams</span><span class="o">.</span><span class="n">scheduler</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Note that the below values are hard-coded for the time being:</dt><dd><ul class="simple">
<li><p>interval: step</p></li>
<li><p>frequency: 1</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer</strong> – pytorch optimizer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scheduler in pytorch-lightning format</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[str, Union[str, int, LambdaLR]</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="trident.core.mixins.optimizer.OptimizerMixin.hparams">
<span class="sig-name descname"><span class="pre">hparams</span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/optimizer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.optimizer.OptimizerMixin.hparams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="trident.core.mixins.optimizer.OptimizerMixin.num_training_steps">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_training_steps</span></span><a class="reference external" href="https://github.com/fdschmidt93/trident/tree/main/trident/core/mixins/optimizer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trident.core.mixins.optimizer.OptimizerMixin.num_training_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the number of training steps per device, accounting for gradient accumulation.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="module-trident.core.mixins">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-trident.core.mixins" title="Permalink to this headline">¶</a></h2>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="trident.core.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">trident.core package</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Fabian David Schmidt |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="_sources/trident.core.mixins.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">trident.core.mixins package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-trident.core.mixins.evaluation">trident.core.mixins.evaluation module</a></li>
<li><a class="reference internal" href="#module-trident.core.mixins.optimizer">trident.core.mixins.optimizer module</a></li>
<li><a class="reference internal" href="#module-trident.core.mixins">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    </body>
</html>